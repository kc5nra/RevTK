var EditStoryComponent=Class.create();EditStoryComponent.prototype={initialize:function(b){uiConsole.log("EditStoryComponent.initialize()");this.evtCache=new uiEventCache();this.bEdit=false;this.sBackupStory="";var a=$("sv-textarea");this.evtCache.addEvent(a,"click",this.evEdit.bind(this));this.evtCache.addEvent(a,"mouseover",this.evHover.bind(this));this.evtCache.addEvent(a,"mouseout",this.evHover.bind(this));this.evtCache.addEvent($("storyedit_cancel"),"click",this.evCancel.bind(this))},destroy:function(){this.evtCache.destroy()},evEdit:function(a){this.editStory()},isEdit:function(){return this.bEdit},editStory:function(a){this.sBackupStory=$("frmStory").value;if(a){$("frmStory").value=a}$("storyview").style.display="none";$("storyedit").style.display="block";var b=$("frmStory");this.setCaretToEnd(b);this.bEdit=true},evHover:function(a){var c=a.type;var b=a.element();if(c=="mouseover"){b.addClassName("hover")}else{b.removeClassName("hover")}},evCancel:function(a){this.doCancel()},doCancel:function(){$("storyedit").style.display="none";$("frmStory").value=this.sBackupStory;$("storyview").style.display="block";this.bEdit=false},setCaretToEnd:function(b){if(b.createTextRange){var a=b.createTextRange();a.collapse(false);a.select()}else{if(b.setSelectionRange){b.focus();var c=b.value.length;b.setSelectionRange(c,c)}}}};